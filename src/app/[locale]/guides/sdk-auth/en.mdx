import {Container} from "@/components/Container"

export const header = {
  title: 'SDK authentication',
  description: 'Authenticating with the SDKs',
}

## Creating a Client

The first step when working with AT data is authenticating. You can authenticate using any [OAuth](/guides/auth) provider, or with <a href="https://github.com/bluesky-social/atproto/tree/main/packages/lex/lex-password-agent" target="_blank">PasswordAgent</a> from our SDK if you are using password auth.

## Typescript

Begin by installing the ATProto SDK packages:

```bash
npm install @atproto/lex @atproto/lex-password-agent
```

Because AT uses regular HTTP verbs and HTTP endpoints, you can also follow this guide by using a CLI tool like cURL to make HTTP requests following the [HTTP Reference](https://docs.bsky.app/docs/category/http-reference) endpoints. Most users will want to use an SDK.

## Password Authentication

If you are using password auth, you should generate an [app password](/specs/xrpc#app-passwords) for your account rather than using your main account password. If you are using Bluesky as an auth provider, you can generate an app password in your [account settings](https://bsky.app/settings/app-passwords).

Start by importing `PasswordAgent`, providing credentials to `PasswordAgent.login()`, and creating an `agent`:

```tsx
import { PasswordAgent } from '@atproto/lex-password-agent'

const result = await PasswordAgent.login({
  service: 'https://bsky.social',
  identifier: 'your-handle.bsky.social',
  password: 'your-app-password',
})

if (result.success) {
    const agent = result.value
}
```

Applications with an end user login flow should use [OAuth](/guides/auth) authentication rather than app password sessions. Password auth is acceptable for bots and command line tools. Both methods will produce the same authenticated `agent`.

## Client Sessions

Once you have a logged-in `agent`, you can create a `Client` instance to read and write data:

```tsx
import { Client } from '@atproto/lex'
const client = new Client(agent)

// Make authenticated API calls
console.log('Logged in as:', agent.did)
```

From here, you can go directly to [making API requests](/guides/reads-and-writes).

## API Tokens

Rate limits for logging in are generally lower than for other API operations. Calling `agent.login()` multiple times in a short period may trigger rate limits. You only need to call `agent.login()` once per session to authenticate your agent.

The `com.atproto.server.createSession` API endpoint called by `agent.login()` returns a session object containing two API tokens:
* `accessJwt`: an access token which is used to authenticate requests but expires after a few minutes
* `refreshJwt`: a refresh token which lasts longer and is used only to update the session with a new access token

The SDK stores this session information for you, and will include it in the headers of its requests.

## Further Reading and Resources

- [Auth](/guides/auth)
- [OAuth patterns](/guides/oauth-patterns)
- [Scopes](/guides/scopes)
- [OAuth spec](/specs/oauth)
- [Permissions spec](/specs/permission)