export const metadata = {
  title: 'Namespaced Identifiers (NSIDs)',
  description: '전역 의미 체계 식별자에 대한 명세입니다.',
}

# Namespaced Identifiers (NSIDs)

Namespaced Identifiers (NSIDs)는 레코드, XRPC 엔드포인트 등 다양한 Lexicon 스키마를 참조하는 데 사용됩니다. {{ className: 'lead' }}

NSID의 기본 구조와 의미는 역순 도메인 네임 형식의 완전한 호스트 이름 다음에 간단한 이름이 이어지는 형태입니다. 호스트 이름 부분은 **도메인 권한**을 나타내며, 마지막 세그먼트는 **이름**을 나타냅니다. {{ className: 'lead' }}

### NSID 구문

Lexicon 문자열 타입: `nsid`

NSID의 도메인 권한 부분은 역순으로 배열된 유효한 핸들이어야 합니다. 그 뒤에는 ASCII 카멜케이스 문자열이어야 하는 이름 세그먼트가 이어집니다.

예를 들어, `com.example.fooBar`는 구문상으로 유효한 NSID로, `com.example`는 도메인 권한이며, `fooBar`는 이름 세그먼트입니다.

구문 규칙의 전체 목록은 다음과 같습니다:

- **전체 NSID:**
    - 오직 ASCII 문자만 포함해야 함
    - 도메인 권한과 이름은 ASCII 마침표 문자(`.`)로 구분되어야 함
    - 최소 3개의 세그먼트를 포함해야 함
    - 총 길이가 최대 317자여야 함
- **도메인 권한:**
    - 마침표(`.`)로 구분된 세그먼트로 구성됨
    - (마침표 포함) 최대 253자이며, 최소 두 개의 세그먼트를 포함해야 함
    - 각 세그먼트는 최소 1자, 최대 63자여야 함 (마침표 제외)
    - 허용되는 문자는 ASCII 알파벳(`a-z`), 숫자(`0-9`), 하이픈(`-`)임
    - 세그먼트는 하이픈으로 시작하거나 끝날 수 없음
    - 첫 번째 세그먼트(최상위 도메인)는 숫자로 시작할 수 없음
    - 도메인 권한은 대소문자를 구분하지 않으며, 소문자로 정규화되어야 함 (즉, ASCII `A-Z`를 `a-z`로 변환)
- **이름:**
    - 최소 1자, 최대 63자여야 함
    - 허용되는 문자는 ASCII 알파벳(`A-Z`, `a-z`)만 가능함
    - 숫자와 하이픈은 허용되지 않음
    - 대소문자를 구분하며 정규화해서는 안 됨

NSID에 대한 참조 정규 표현식은:

```
/^[a-zA-Z]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(\.[a-zA-Z]([a-zA-Z]{0,61}[a-zA-Z])?)$/
```

### NSID 구문 변형

일부 상황에서는 스키마 내 특정 하위 필드를 참조하기 위해 NSID에 **프래그먼트**를 추가할 수 있습니다. 프래그먼트는 NSID와 ASCII 해시 문자(`#`)로 구분됩니다. 프래그먼트 식별자 문자열(즉, `#` 뒤의 부분)은 NSID의 마지막 세그먼트와 동일한 구문 제한을 가집니다: ASCII 알파벳, 하나 이상의 문자, 길이 제한 등.

NSID의 그룹이나 패턴을 참조할 때는, 끝에 ASCII 별표 문자(`*`)를 "글로브(glob)" 문자로 사용할 수 있습니다. 예를 들어, `com.atproto.*`는 `atproto.com` 도메인 권한 아래의 모든 NSID(중첩된 하위 도메인 포함)를 참조합니다. 독립적인 `*`는 모든 도메인 권한의 모든 NSID와 매칭됩니다. 현재는 단 하나의 별표 문자만 허용되며, 반드시 마지막 문자여야 하고, 세그먼트 경계에 있어야 합니다 (세그먼트 이름의 일부만 매칭하는 것은 불가능). 즉, 별표 문자는 마침표 뒤에 오거나, 모든 NSID와 매칭되는 독립된 별표여야 합니다.

### 예시

구문상 유효한 NSID:

```
com.example.fooBar
net.users.bob.ping
a-0.b-1.c
a.b.c
cn.8.lex.stuff
```

유효하지 않은 NSID:

```
com.exa💩ple.thing
com.example
```

### 사용 및 구현 지침

**강력히 권장되는** 최선의 관행은 도메인 권한에 ASCII 알파벳 문자만 사용하는 것입니다 (즉, 숫자나 하이픈을 사용하지 않음). 이는 대부분의 프로그래밍 언어에서 클라이언트 라이브러리를 생성하는 데 크게 용이합니다.

전체 NSID는 표시, 저장, 검증에 있어서 대소문자를 구분합니다. 그러나 대소문자만 다른 여러 NSID를 허용해서는 안 됩니다. 네임스페이스 권한은 중복과 혼란을 방지할 책임이 있습니다. 구현체는 NSID를 강제로 소문자로 변환해서는 안 됩니다.

관련 NSID를 체계적으로 구성하기 위해 도메인 권한의 일부로 "서브도메인"을 사용하는 것이 일반적입니다. 예를 들어, NSID `com.atproto.sync.getHead`는 `sync` 세그먼트를 사용합니다. 이는 `atproto.com` 도메인뿐만 아니라 `sync.atproto.com` 전체 도메인에 대한 제어 권한이 필요함을 의미합니다.

Lexicon 언어 문서에는 레코드 유형 및 XRPC 메서드에 대해 NSID를 선택하고 구성하는 스타일 가이드라인이 제공될 것입니다. 요약하면, 레코드는 보통 복수형이 아닌 단수 명사이며, XRPC 메서드는 보통 "동사명사(verbNoun)" 형태를 취합니다.

### 향후 변경 가능성

NSID 구문이 마지막 세그먼트에 유니코드 문자를 허용하도록 완화될 가능성이 있습니다.

"글로브(glob)" 구문 변형은 단일 레벨과 중첩 매칭의 구분을 보다 명확하게 하기 위해 확장될 수 있습니다.

"프래그먼트(fragment)" 구문 변형은 향후 중첩 참조를 허용하도록 완화될 수 있습니다.

현재 "도메인 권한"의 제어를 검증하는 자동화된 메커니즘은 존재하지 않습니다. 또한, 주어진 NSID에 대한 Lexicon 스키마를 가져오거나 기본 도메인의 모든 NSID를 열거하는 자동화된 메커니즘도 존재하지 않습니다.
